<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Machine's Real-Time Localisation â€” Dashboard</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
    
<header class="site-header">
  <div class="logo-pair">
    <img class="logo logo-umpsa" src="images/logoUmpsa.png" alt="UMPSA Logo">
    <img class="logo logo-kkm" src="images/logoKKM.png" alt="KKM Logo">
    <img class="logo logo-project" src="images/logoProject.png" alt="Project Logo">
    <!-- <img class="logo logo-kkm" src="images/logoKKM.png" alt="KKM Logo"> -->
  </div>
  <h1 class="site-title">Machine's Real-Time Localisation</h1>
  <div class="site-datetime" id="siteDateTime">Loading date & time...</div>
</header>

  <main class="main-container" id="mainContainer">
    <!-- LOGIN BOX -->
    <div class="form-box login-box">
      <h2>Hospital's Staff Login</h2>
      <input type="text" id="loginStaffId" placeholder="Staff ID">
      <input type="password" id="loginPassword" placeholder="Password">
      <button onclick="doLogin()">Login</button>
      <p class="small-links">
        <a href="#" onclick="showRegister()">Register</a> |
        <a href="#" onclick="showForgot()">Forgot Password?</a>
      </p>
      <p class="message" id="msgLogin"></p>
    </div>

    <!-- REGISTER BOX -->
    <div class="form-box register-box hidden" id="registerBox">
      <h2>Register New Staff</h2>
      <input type="text" id="regStaffId" placeholder="Staff ID">
      <input type="text" id="regName" placeholder="Full Name">
      <input type="email" id="regEmail" placeholder="Email">
      <input type="text" id="regPhone" placeholder="Phone Number">
      <input type="password" id="regPassword" placeholder="Password">
      <label>Security Question 1</label>
      <select id="regQ1">
        <option value="color">Favorite color</option>
        <option value="pet">Pet's name</option>
        <option value="school">Primary school</option>
      </select>
      <input type="text" id="regA1" placeholder="Answer 1">
      <label>Security Question 2</label>
      <select id="regQ2">
        <option value="mother">Mother's maiden name</option>
        <option value="city">City born</option>
        <option value="food">Favorite food</option>
      </select>
      <input type="text" id="regA2" placeholder="Answer 2">
      <button onclick="doRegister()">Submit</button>
      <p class="small-links">
        <a href="#" onclick="showLogin()">Back to Login</a>
      </p>
      <p class="message" id="msgRegister"></p>
    </div>

    <!-- FORGOT BOX -->
    <div class="form-box forgot-box hidden" id="forgotBox">
      <h2>Forgot Password</h2>
      <input type="text" id="forgotStaffId" placeholder="Staff ID">
      <label>Choose Question</label>
      <select id="forgotQno">
        <option value="color">Question 1: Favorite color</option>
        <option value="pet">Question 2: Pet's name</option>
        <option value="school">Question 3: Primary school</option>
      </select>
      <input type="text" id="forgotAnswer" placeholder="Answer">
      <input type="password" id="forgotNewPassword" placeholder="New Password">
      <button onclick="doForgot()">Reset Password</button>
      <p class="small-links">
        <a href="#" onclick="showLogin()">Back to Login</a>
      </p>
      <p class="message" id="msgForgot"></p>
    </div>

    <!-- DASHBOARD -->
    <div class="dashboard hidden" id="dashboardBox">
      <section class="dashboard-staff">
        <h2>Staff Profile</h2>
        <div id="staffProfile"></div>
      </section>

      <section class="dashboard-boxes">
        <div class="box" id="boxStaffData">
          <h3>Staff Data Search</h3>
          <button onclick="showAllStaff()">Display All Staff</button>
          <div id="staffList"></div>
        </div>

        <!-- <div class="box" id="boxMachine">
          <h3>Machine Register/Disposal</h3>
          <button onclick="dummyMachineData()">Insert Dummy Machine</button>
          <div id="machineList"></div>
        </div> -->
        <section class="machine-input">
          
  <h2>Machine Data Entry</h2>
  <form id="machineForm">
    <div class="form-group">
      <label for="machineCode">Machine Code:</label>
      <input type="text" id="machineCode" name="machineCode" required>
    </div>

    <div class="form-group">
      <label for="machineLocation">Machine Location:</label>
      <input type="text" id="machineLocation" name="machineLocation" required>
    </div>

    <div class="form-group">
      <label for="currentUser">Current User:</label>
      <input type="text" id="currentUser" name="currentUser" required>
    </div>

    <div class="form-group">
      <label for="machineRequest">Request:</label>
      <textarea id="machineRequest" name="machineRequest" placeholder="Enter request if any"></textarea>
    </div>

    <button type="submit">Submit</button>
  </form>
</section>

<script>
  const form = document.getElementById('machineForm');
  form.addEventListener('submit', async (e) => {
    e.preventDefault();

    const data = {
      machineCode: form.machineCode.value,
      machineLocation: form.machineLocation.value,
      currentUser: form.currentUser.value,
      machineRequest: form.machineRequest.value,
    };

    // Hantar data ke backend
    try {
      const res = await fetch('/api/machine', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data)
      });

      const result = await res.json();
      if(result.success) {
        alert('Data submitted successfully!');
      }
    } catch(err) {
      console.error(err);
      alert('Error submitting data.');
    }
  });
</script>


        <div class="box" id="boxMapping">
          <h3>Realtime Mapping</h3>
          <iframe id="mapFrame" src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3974.528507521721!2d112.00713861441285!3d2.334543198027953!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x31fbc3e4272e511f%3A0x7d6d10bdfedf9c5c!2sKuching%2C%20Sarawak!5e0!3m2!1sen!2smy!4v1694786823451!5m2!1sen!2smy" style="width:100%; height:200px;"></iframe>
        </div>

        <div class="box" id="boxAduan">
          <h3>Aduan</h3>
          <textarea id="aduanText" placeholder="Type your complaint..."></textarea>
          <button onclick="submitAduan()">Submit</button>
          <div id="aduanList"></div>
        </div>
      </section>
    </div>
  </main>

  <script src="script.js"></script>
</body>
</html>
